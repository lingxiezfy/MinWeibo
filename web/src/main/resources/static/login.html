<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta charset="utf-8"/>
    <title>MINI微社区</title>

    <meta name="description" content="User login page"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>

    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="ace/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="ace/font-awesome/4.5.0/css/font-awesome.min.css"/>

    <!-- page specific plugin styles -->
    <link rel="stylesheet" href="ace/css/bootstrap-datepicker3.min.css"/>
    <link href="css/toastr.min.css" rel="stylesheet">

    <!-- text fonts -->
    <link rel="stylesheet" href="ace/css/fonts.googleapis.com.css"/>

    <!-- ace styles -->
    <link rel="stylesheet" href="ace/css/ace.min.css"/>

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="ace/css/ace-part2.min.css"/>
    <![endif]-->
    <link rel="stylesheet" href="ace/css/ace-rtl.min.css"/>

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="ace/css/ace-ie.min.css"/>
    <![endif]-->

    <!-- inline styles related to this page -->
    <link rel="stylesheet" href="css/login.css"/>

    <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

    <!--[if lte IE 8]>
    <script src="ace/js/html5shiv.min.js"></script>
    <script src="ace/js/respond.min.js"></script>
    <![endif]-->
</head>

<body class="login-layout light-login">
<div class="main-container">
    <div class="main-content">
        <div class="row">
            <div class="space-6"></div>
            <div class="col-sm-10 col-sm-offset-1">
                <div class="login-container">
                    <div class="center">
                        <h1>
                            <span class="red">登录</span>
                            <span class="white" id="id-text2">发现新鲜事</span>
                        </h1>
                        <h4 class="blue" id="id-company-text">&copy; MINI微社区</h4>
                    </div>

                    <div class="space-6"></div>

                    <div class="position-relative">
                        <div id="login-box" class="login-box visible widget-box no-border">
                            <div class="widget-body">
                                <div class="widget-main">
                                    <div class="space-6"></div>
                                    <form id="loginForm">
                                        <fieldset>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="text" class="form-control" placeholder="用户名"
                                                                   name="username"/>
															<i class="ace-icon fa fa-user"></i>
														</span>
                                            </label>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="password" class="form-control" placeholder="密码"
                                                                   name="password"/>
															<i class="ace-icon fa fa-lock"></i>
														</span>
                                            </label>

                                            <div class="space"></div>

                                            <div class="clearfix">
                                                <label class="inline">
                                                    <input type="checkbox" class="ace" checked/>
                                                    <span class="lbl"> 记住密码</span>
                                                </label>

                                                <button type="button" id="loginBtn"
                                                        class="width-35 pull-right btn btn-sm btn-primary">
                                                    <span class="bigger-110">进入</span>
                                                </button>
                                            </div>
                                        </fieldset>
                                    </form>
                                </div><!-- /.widget-main -->

                                <div class="toolbar clearfix">
                                    <div>&nbsp;</div>
                                    <div>
                                        <a href="#" data-target="#signup-box" class="user-signup-link">
                                            没有帐号？直接注册...
                                            <i class="ace-icon fa fa-arrow-right"></i>
                                        </a>
                                    </div>
                                </div>
                            </div><!-- /.widget-body -->
                        </div><!-- /.login-box -->

                        <div id="signup-box" class="signup-box widget-box no-border">
                            <div class="widget-body">
                                <div class="widget-main">
                                    <h4 class="header green lighter bigger">
                                        <i class="ace-icon fa fa-users blue"></i>
                                        新用户注册
                                    </h4>

                                    <div class="space-6"></div>
                                    <p> 填写您的帐号信息: </p>

                                    <form id="registerForm">
                                        <fieldset>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="text" class="form-control"
                                                                   placeholder="用户名(3-10位数字、字母)" name="username"/>
															<i class="ace-icon fa fa-user"></i>
														</span>
                                            </label>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="text" class="form-control" placeholder="昵称"
                                                                   name="nickname"/>
															<i class="ace-icon fa fa-info-circle"></i>
														</span>
                                            </label>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="password" class="form-control"
                                                                   placeholder="密码(6-18位数字、字母、下划线)" name="password"/>
															<i class="ace-icon fa fa-lock"></i>
														</span>
                                            </label>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="password" class="form-control"
                                                                   placeholder="再输一次密码" name="rePassword"/>
															<i class="ace-icon fa fa-retweet"></i>
														</span>
                                            </label>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input class="form-control date-picker" placeholder="生日"
                                                                   id="id-date-picker-bir" name="bir" type="text"
                                                                   data-date-format="yyyy-mm-dd"/>
															<i class="ace-icon fa fa-calendar"></i>
														</span>
                                            </label>
                                            <label class="block clearfix">
                                                <div class="radio">
                                                    <label>
                                                        <input name="sex" type="radio" value="0" class="ace"/>
                                                        <span class="lbl"> 汉子</span>
                                                    </label>
                                                    <label>
                                                        <input name="sex" type="radio" value="1" class="ace"/>
                                                        <span class="lbl"> 仙女</span>
                                                    </label>
                                                </div>
                                            </label>
                                            <label class="block">
                                                <input name="acceptProtocol" type="checkbox" value="1" class="ace"/>
                                                <span class="lbl">
															接受MINI微社区用户协议
														</span>
                                            </label>

                                            <div class="space-24"></div>

                                            <div class="clearfix">
                                                <button type="reset" class="width-30 pull-left btn btn-sm">
                                                    <i class="ace-icon fa fa-refresh"></i>
                                                    <span class="bigger-110">重置</span>
                                                </button>

                                                <button type="button" id="registerBtn"
                                                        class="width-65 pull-right btn btn-sm btn-success">
                                                    <span class="bigger-110">注册</span>
                                                    <i class="ace-icon fa fa-arrow-right icon-on-right"></i>
                                                </button>
                                            </div>
                                        </fieldset>
                                    </form>
                                </div>

                                <div class="toolbar center">
                                    <a href="#" data-target="#login-box" class="back-to-login-link">
                                        <i class="ace-icon fa fa-arrow-left"></i>
                                        返回登录
                                    </a>
                                </div>
                            </div><!-- /.widget-body -->
                        </div><!-- /.signup-box -->
                    </div><!-- /.position-relative -->
                </div>
            </div><!-- /.col -->
        </div><!-- /.row -->
    </div><!-- /.main-content -->
</div><!-- /.main-container -->

<!-- basic scripts -->

<!--[if !IE]> -->
<script src="ace/js/jquery-2.1.4.min.js"></script>


<!-- <![endif]-->

<!--[if IE]>
<script src="ace/js/jquery-1.11.3.min.js"></script>
<![endif]-->
<script type="text/javascript">
    if ('ontouchstart' in document.documentElement) document.write("<script src='ace/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
</script>
<script src="ace/js/bootstrap.min.js"></script>

<!-- page specific plugin scripts -->

<script src="ace/js/bootstrap-datepicker.min.js"></script>
<script src="js/toastr.min.js"></script>
<script src="js/sweetalert.min.js"></script>

<script src="js/common.js"></script>
<!-- inline scripts related to this page -->
<script type="text/javascript">
    toastr.options.positionClass = 'toast-top-right';
    toastr.options.timeOut = 1200;
    jQuery(function ($) {
        $(document).on('click', '.toolbar a[data-target]', function (e) {
            e.preventDefault();
            var target = $(this).data('target');
            $('.widget-box.visible').removeClass('visible');//hide others
            $(target).addClass('visible');//show target
        });
        $('.date-picker').datepicker({
            autoclose: true,
            todayHighlight: true,
            endDate: new Date()
        });
    });
    //loginForm
    $("#loginBtn").click(function () {
        $.ajax({
            url: loginUrl,
            type: "post",
            data: JSON.stringify($("#loginForm").serializeObject()),
            contentType: "application/json;charset=utf-8",
            success: function (response) {
                console.log(response);
                if (response.success && response.code === '200') {
                    handleLocalStorage("set", userTokenStorageKey, response.result.token);
                    handleLocalStorage("set", userIdStorageKey, response.result.userId);
                    //跳转主页
                    toastr.info('登录成功');
                    document.getElementById("loginForm").reset();
                    swal("登录成功，即将进入主页!", {
                        buttons: false,
                        timer: 2000,
                    });
                    setTimeout(function () {
                        window.location.href = 'home.html?userId='
                    }, 1500);
                } else {
                    toastr.error(response.message);
                }
            },
            error: function (e) {
                console.log(e);
            }
        });
    });
    //registerForm
    $("#registerBtn").click(function () {
        $.ajax({
            url: registerUrl,
            type: "post",
            data: JSON.stringify($("#registerForm").serializeObject()),
            contentType: "application/json;charset=utf-8",
            beforeSend: function () {
                if (!$("input[name=acceptProtocol]").prop('checked')) {
                    toastr.warning("请勾选协议");
                    return false;
                }
            },
            success: function (response) {
                console.log(response);
                if (response.success && response.code === '200') {
                    handleLocalStorage("set", userTokenStorageKey, response.result.token);
                    handleLocalStorage("set", userIdStorageKey, response.result.userId);
                    //跳转主页
                    toastr.info('注册成功');
                    document.getElementById("registerForm").reset();
                    swal("注册成功，正在为您开启主页!", {
                        buttons: false,
                        timer: 2000,
                    });
                    setTimeout(function () {
                        window.location.href = 'home.html?userId='
                    }, 1500);
                } else {
                    toastr.error(response.message);
                }
            },
            error: function (e) {
                console.log(e);
            }
        });
    });
</script>
</body>
</html>
